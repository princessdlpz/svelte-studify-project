import{f as L}from"../chunks/fetch-refresh.CoktrdpI.js";import{e as A,b as C,i as D}from"../chunks/index.DJuFnhGY.js";import{a as l,t as c,h as S,c as _,e as t,d as I,f as g}from"../chunks/disclose-version.B-hLH5kf.js";import{p as J,l as R,c as F,a as Y,g as i,r as z,m as $,s as y,d as T,b as U,M as q}from"../chunks/runtime.DDjRgbeA.js";import{i as E}from"../chunks/if.BIDFABO2.js";import{i as G}from"../chunks/lifecycle.Dwr_-_8E.js";import"../chunks/entry.C4uEBCSM.js";import{B as M}from"../chunks/Button.Dse6T-Vv.js";import"../chunks/HeaderNav.svelte_svelte_type_style_lang.BOaGD4ME.js";import{C as H}from"../chunks/Card.DpYgZsTY.js";import{t as K}from"../chunks/toasts.cn0VEhPp.js";import{P as Q}from"../chunks/Pagination.DKPg6NiN.js";import{P as V}from"../chunks/PlaylistForm.D-Hu4pxy.js";import{M as W}from"../chunks/Modal.Hglc8NYm.js";import{l as X}from"../chunks/micromodal.es.CJCzk-G3.js";const Z=async({fetch:h,url:s})=>{const n=s.searchParams.get("page"),P=new URLSearchParams({limit:"18",offset:n?`${18*(Number(n)-1)}`:"0"}).toString(),d=await L(h,`/api/spotify/me/playlists?${P}`);if(!d.ok)throw A(d.status,"Failed to load playlists!");return{userPlaylists:await d.json(),title:"Your Playlists"}},Pt=Object.freeze(Object.defineProperty({__proto__:null,load:Z},Symbol.toStringTag,{value:"Module"}));var tt=c("+ Add New",1),at=c('<div class="title svelte-ap3in5"><h1> </h1> <!></div> <div class="grid-items svelte-ap3in5"></div> <!>',1),et=c("+ Add New",1),st=c('<div class="empty svelte-ap3in5"><p class="svelte-ap3in5">No Playlists Yet!</p> <!></div>'),rt=c('<div class="content svelte-ap3in5"><!></div> <!>',1);function wt(h,s){J(s,!1);const a=$();let n=$(!1);async function P(){if(!i(a).next)return;y(n,!0);const r=await fetch(i(a).next.replace("https://api.spotify.com/v1/","/api/spotify/"));if(r.ok){const e=await r.json();y(a,{...e,items:[...i(a).items,...e.items]})}else K.error("Could not load data!");y(n,!1)}R(()=>U(s.data),()=>{y(a,s.data.userPlaylists)}),F(),G();var d=rt(),w=g(d),O=_(w);E(O,()=>i(a).items.length>0,r=>{var e=at(),o=g(e),m=_(o),p=_(m),f=t(t(m,!0));M(f,{element:"a",href:"/playlists/new",$$events:{click:v=>{v.preventDefault(),X.show("add-playlist-modal")}},children:(v,b)=>{var N=tt();l(v,N)}});var u=t(t(o,!0));C(u,9,()=>i(a).items,D,(v,b,N)=>{var x=S(),B=g(x);H(B,{get item(){return q(b)}}),l(v,x)});var k=t(t(u,!0));Q(k,{get paginatedList(){return i(a)},get isLoading(){return i(n)},$$events:{loadmore:P}}),z(()=>I(p,s.data.title)),l(r,e)},r=>{var e=st(),o=_(e),m=t(t(o,!0));M(m,{element:"a",href:"/playlists/new",children:(p,f)=>{var u=et();l(p,u)}}),l(r,e)});var j=t(t(w,!0));W(j,{id:"add-playlist-modal",title:"Add a New Playlist",children:(r,e)=>{var o=S(),m=g(o),p=T(()=>{var f;return(f=s.data.user)==null?void 0:f.id});V(m,{get form(){return s.form},get userID(){return i(p)},action:"/playlists/new"}),l(r,o)}}),l(h,d),Y()}export{wt as component,Pt as universal};
