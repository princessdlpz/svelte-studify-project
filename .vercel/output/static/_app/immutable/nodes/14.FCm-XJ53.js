import{f as I}from"../chunks/fetch-refresh.CoktrdpI.js";import{e as P,b as L,i as O}from"../chunks/index.DJuFnhGY.js";import{a as y,t as k,d as A,c as x,e as _,h as R,f as N}from"../chunks/disclose-version.B-hLH5kf.js";import{p as F,l as J,c as z,r as C,a as M,g as l,m as j,s as w,b as T,M as q}from"../chunks/runtime.DDjRgbeA.js";import{i as D}from"../chunks/if.BIDFABO2.js";import{i as U}from"../chunks/lifecycle.Dwr_-_8E.js";import"../chunks/entry.DFsZ7VbH.js";import"../chunks/HeaderNav.svelte_svelte_type_style_lang.BOaGD4ME.js";import{C as B}from"../chunks/Card.DpYgZsTY.js";import{t as E}from"../chunks/toasts.DKt_b5Ez.js";import{P as G}from"../chunks/Pagination.C2OWy05d.js";const H=async({params:b,fetch:d,url:s,depends:g,route:h})=>{const r=i=>I(d,i);g(`app:${h.id}`);const{list:c,rest:p}=b,v=18,o=s.searchParams.get("page"),e=new URLSearchParams({limit:`${v}`,offset:o?`${v*(Number(o)-1)}`:"0"}).toString();let t,n;if(c==="section"&&p==="new-releases")t=r(`/api/spotify/browse/new-releases?${e}`),n="New Releases";else if(c==="section"&&p==="featured-playlists")t=r(`/api/spotify/browse/featured-playlists?${e}`),n="Featured Playlists";else if(c==="category"){t=r(`/api/spotify/browse/categories/${p}/playlists?${e}`);const i=await r(`/api/spotify/browse/categories/${p}`),f=i.ok?await i.json():void 0;n=f?`${f.name} Playlists`:"Playlists"}else if(c==="profile"&&p==="following")t=await r(`/api/spotify/me/following?type=artist&${e}`),n="Following";else if(c==="artist"){const i=p.split("/")[0],f=p.split("/")[1];if(!i||!["albums","appears-on","related-artists"].includes(f))throw P(404,{message:"Page not found!"});const S=await r(`/api/spotify/artists/${i}`),u=S.ok?await S.json():void 0;f==="albums"&&(t=r(`/api/spotify/artists/${i}/albums?include_groups=album,single&${e}`),n=u?`${u.name} Albums`:"Albums"),f==="appears-on"&&(t=r(`/api/spotify/artists/${i}/albums?include_groups=appears_on&${e}`),n=u?`${u.name} Appearances`:"Appearances"),f==="related-artists"&&(t=r(`/api/spotify/artists/${i}/related-artists`),n=u?`Related to ${u.name}`:"Related Artists")}if(!t)throw P(404,"Page Not Found!");const m=await t;if(!m.ok)throw P(m.status,"Failed to Load Data!");const a=await m.json();return{data:(()=>{if("items"in a)return a;if("playlists"in a)return a.playlists;if("albums"in a)return a.albums;if("artists"in a)return"items"in a.artists?a.artists:{items:a.artists}})(),title:n}},nt=Object.freeze(Object.defineProperty({__proto__:null,load:H},Symbol.toStringTag,{value:"Module"}));var K=k('<div class="grid-item"><!></div>'),Q=k('<div class="grid-items svelte-zggvko"></div> <!>',1),V=k('<div class="content svelte-zggvko"><h1> </h1> <!></div>');function lt(b,d){F(d,!1);const s=j();let g=j(!1);const h=async()=>{if(l(s)&&"next"in l(s)&&l(s).next){w(g,!0);const o=await fetch(l(s).next.replace("https://api.spotify.com/v1/","/api/spotify/"));if(o.ok){const e=await o.json(),t=e.albums||e.playlists||e.artists||e;w(s,{...t,items:[...l(s).items,...t.items]})}else E.error("Could not load data!");w(g,!1)}};J(()=>T(d.data),()=>{w(s,d.data.data)}),z(),U();var r=V(),c=x(r),p=x(c),v=_(_(c,!0));D(v,()=>{var o;return(o=l(s))==null?void 0:o.items},o=>{var e=Q(),t=N(e);L(t,9,()=>l(s).items,O,(m,a,$)=>{var i=K(),f=x(i);B(f,{get item(){return q(a)}}),y(m,i)});var n=_(_(t,!0));D(n,()=>"next"in l(s),m=>{var a=R(),$=N(a);G($,{get paginatedList(){return l(s)},get isLoading(){return l(g)},$$events:{loadmore:h}}),y(m,a)}),y(o,e)}),C(()=>A(p,d.data.title)),y(b,r),M()}export{lt as component,nt as universal};
