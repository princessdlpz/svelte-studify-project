import{e as Q,b as S,i as U}from"../chunks/index.DJuFnhGY.js";import{f as W}from"../chunks/fetch-refresh.CoktrdpI.js";import{h as X,a as r,t as o,f as Y,d as Z,b as N,c as l,e}from"../chunks/disclose-version.B-hLH5kf.js";import{p as J,l as j,c as tt,g as t,r as at,a as et,m as R,d as O,s as x,b as B,M as D}from"../chunks/runtime.DDjRgbeA.js";import{i as M}from"../chunks/if.BIDFABO2.js";import{i as st}from"../chunks/lifecycle.Dwr_-_8E.js";import"../chunks/entry.DUdA-Hzd.js";import{B as E}from"../chunks/Button.Dse6T-Vv.js";import"../chunks/HeaderNav.svelte_svelte_type_style_lang.BOaGD4ME.js";import{C as G}from"../chunks/Card.DpYgZsTY.js";import{I as rt}from"../chunks/ItemPage.C-H0ZPAG.js";import{T as it}from"../chunks/Player.CCm4elbP.js";const lt=async({fetch:z,params:a,parent:V,depends:i,route:w})=>{var b;i(`app:${w.id}`);const n=T=>W(z,T),{user:u}=await V(),_=await n(`/api/spotify/artists/${a.id}`);if(!_.ok)throw Q(_.status,"Failed to load artist!");const v=await _.json();let I;((b=v==null?void 0:v.images)==null?void 0:b.length)>0&&(I=n(`/api/average-color?${new URLSearchParams({image:v==null?void 0:v.images[0].url}).toString()}`));const[$,C,q,L,c]=await Promise.all([n(`/api/spotify/artists/${a.id}/albums?limit=6&include_groups=album,single`),n(`/api/spotify/artists/${a.id}/albums?limit=6&include_groups=appears_on`),n(`/api/spotify/artists/${a.id}/top-tracks?market=${u==null?void 0:u.country}`),n(`/api/spotify/artists/${a.id}/related-artists`),I]);return{title:v.name,artist:v,artistAlbums:$.ok?$.json():void 0,artistAppearsOn:C.ok?C.json():void 0,artistTopTracks:q.ok?q.json():void 0,artistRelatedArtists:L.ok?L.json():void 0,color:c!=null&&c.ok?c.json().then(T=>T.color):null}},It=Object.freeze(Object.defineProperty({__proto__:null,load:lt},Symbol.toStringTag,{value:"Module"}));var ot=o('<div class="section svelte-nc0tqw"><div class="section-title svelte-nc0tqw"><h2 class="svelte-nc0tqw">Top Tracks</h2></div> <!></div>'),nt=o('View All <span class="visually-hidden">Albums</span>',1),dt=o('<div class="grid-item"><!></div>'),vt=o('<div class="section svelte-nc0tqw"><div class="section-title svelte-nc0tqw"><h2 class="svelte-nc0tqw">Albums</h2> <!></div> <div class="grid-items"></div></div>'),ct=o('View All <span class="visually-hidden">artist appearances</span>',1),mt=o('<div class="grid-item"><!></div>'),ut=o('<div class="section svelte-nc0tqw"><div class="section-title svelte-nc0tqw"><h2 class="svelte-nc0tqw">Appears On</h2> <!></div> <div class="grid-items"></div></div>'),_t=o('View All <span class="visually-hidden">Related Artists</span>',1),gt=o('<div class="grid-item"><!></div>'),ft=o('<div class="section svelte-nc0tqw"><div class="section-title svelte-nc0tqw"><h2 class="svelte-nc0tqw">Related Artists</h2> <!></div> <div class="grid-items"></div></div>'),pt=o('<div class="content"><!> <!> <!> <!></div>'),ht=o('<p class="meta" slot="meta"> </p>');function Ft(z,a){J(a,!1);const V=R(),i=R(),w=R(),n=R(),u=R(),_=R(),v=Intl.NumberFormat("en",{notation:"compact"});j(()=>B(a.data),()=>{x(V,a.data.color)}),j(()=>B(a.data),()=>{x(i,a.data.artist)}),j(()=>B(a.data),()=>{x(w,a.data.artistTopTracks)}),j(()=>B(a.data),()=>{x(n,a.data.artistAlbums)}),j(()=>B(a.data),()=>{x(u,a.data.artistRelatedArtists)}),j(()=>B(a.data),()=>{x(_,a.data.artistAppearsOn)}),tt(),st();var I=X(),$=Y(I),C=O(()=>t(i).images.length?t(i).images[0].url:void 0);rt($,{get title(){return t(i).name},get image(){return t(C)},get color(){return t(V)},get type(){return t(i).type},children:(q,L)=>{var c=pt(),b=l(c);M(b,()=>t(w)&&t(w).tracks.length>0,k=>{var d=ot(),m=l(d),y=e(e(m,!0)),A=O(()=>{var g;return(g=a.data.userAllPlaylists)==null?void 0:g.filter(P=>{var s;return P.owner.id===((s=a.data.user)==null?void 0:s.id)})});it(y,{get tracks(){return t(w).tracks},get userPlaylists(){return t(A)},get total(){return t(w).tracks.length},get title(){return t(i).name}}),r(k,d)});var T=e(e(b,!0));M(T,()=>t(n)&&t(n).items.length>0,k=>{var d=vt(),m=l(d),y=l(m),A=e(e(y,!0)),g=O(()=>`/artist/${t(i).id}/albums`);E(A,{element:"a",get href(){return t(g)},variant:"outline",children:(s,f)=>{var p=nt();r(s,p)}});var P=e(e(m,!0));S(P,9,()=>t(n).items,U,(s,f,p)=>{var h=dt(),F=l(h);G(F,{get item(){return D(f)}}),r(s,h)}),r(k,d)});var H=e(e(T,!0));M(H,()=>t(_)&&t(_).items.length>0,k=>{var d=ut(),m=l(d),y=l(m),A=e(e(y,!0)),g=O(()=>`/artist/${t(i).id}/appears-on`);E(A,{element:"a",get href(){return t(g)},variant:"outline",children:(s,f)=>{var p=ct();r(s,p)}});var P=e(e(m,!0));S(P,9,()=>t(_).items,U,(s,f,p)=>{var h=mt(),F=l(h);G(F,{get item(){return D(f)}}),r(s,h)}),r(k,d)});var K=e(e(H,!0));M(K,()=>t(u)&&t(u).artists.length>0,k=>{var d=ft(),m=l(d),y=l(m),A=e(e(y,!0)),g=O(()=>`/artist/${t(i).id}/related-artists`);E(A,{element:"a",get href(){return t(g)},variant:"outline",children:(s,f)=>{var p=_t();r(s,p)}});var P=e(e(m,!0));S(P,9,()=>t(u).artists.splice(0,6),U,(s,f,p)=>{var h=gt(),F=l(h);G(F,{get item(){return D(f)}}),r(s,h)}),r(k,d)}),r(q,c)},$$slots:{meta:(q,L)=>{var c=ht(),b=l(c);at(()=>Z(b,`${N(v.format(t(i).followers.total))} Followers`)),r(q,c)}}}),r(z,I),et()}export{Ft as component,It as universal};
