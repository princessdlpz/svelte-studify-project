import{f as M}from"../chunks/fetch-refresh.CoktrdpI.js";import{e as z,b as A,i as J}from"../chunks/index.DJuFnhGY.js";import{h as N,a as x,t as P,f as j,d as u,c as l,e as r,b as R}from"../chunks/disclose-version.B-hLH5kf.js";import{p as U,l as I,c as Y,g as a,r as g,a as q,m as T,d as $,s as D,b as L,M as O}from"../chunks/runtime.DDjRgbeA.js";import{i as B}from"../chunks/lifecycle.Dwr_-_8E.js";import"../chunks/entry.C4uEBCSM.js";import"../chunks/HeaderNav.svelte_svelte_type_style_lang.BOaGD4ME.js";import{I as E}from"../chunks/ItemPage.C-H0ZPAG.js";import{T as G}from"../chunks/Player.CEPOGhM8.js";function H(s){switch(s){case"R":return"®";case"P":return"℗";case"C":return"©";default:return s}}const K=async({fetch:s,params:e,depends:t,route:d})=>{t(`app:${d.id}`);const o=await M(s,`/api/spotify/albums/${e.id}`);if(!o.ok)throw z(o.status,"Failed to load album!");const n=await o.json();let v=null;if(n.images.length>0){const i=await s(`/api/average-color?${new URLSearchParams({image:n.images[0].url}).toString()}`);i.ok&&(v=(await i.json()).color)}return{album:n,title:n.name,color:v}},nt=Object.freeze(Object.defineProperty({__proto__:null,load:K},Symbol.toStringTag,{value:"Module"}));var Q=P('<p class="copyright svelte-gpt37x"> </p>'),V=P('<!> <div class="credits svelte-gpt37x"><p class="date svelte-gpt37x"> </p> <!></div>',1),W=P('<p class="meta svelte-gpt37x" slot="meta"><span class="artists svelte-gpt37x"> </span> <span class="date svelte-gpt37x"> </span> <span class="tracks-count svelte-gpt37x"> </span></p>');function it(s,e){U(e,!1);const t=T(),d=T();I(()=>L(e.data),()=>{D(t,e.data.album)}),I(()=>L(e.data),()=>{D(d,e.data.color)}),Y(),B();var o=N(),n=j(o),v=$(()=>a(t).images.length>0?a(t).images[0].url:void 0);E(n,{get title(){return a(t).name},get type(){return a(t).album_type},get color(){return a(d)},get image(){return a(v)},children:(i,C)=>{var m=V(),p=j(m),y=$(()=>{var c;return(c=e.data.userAllPlaylists)==null?void 0:c.filter(b=>{var w;return b.owner.id===((w=e.data.user)==null?void 0:w.id)})});G(p,{get tracks(){return a(t).tracks.items},get userPlaylists(){return a(y)},get total(){return a(t).tracks.total},get title(){return a(t).name}});var _=r(r(p,!0)),f=l(_),h=l(f);g(()=>u(h,new Date(a(t).release_date).toLocaleDateString("en",{dateStyle:"medium"})));var k=r(r(f,!0));A(k,1,()=>a(t).copyrights,J,(c,b,w)=>{var S=Q(),F=l(S);g(()=>u(F,`${R(H(O(b).type))}
				${R(O(b).text)}`)),x(c,S)}),x(i,m)},$$slots:{meta:(i,C)=>{var m=W(),p=l(m),y=l(p);g(()=>u(y,a(t).artists.map(c=>c.name).join(", ")));var _=r(r(p,!0)),f=l(_);g(()=>u(f,new Date(a(t).release_date).getFullYear()));var h=r(r(_,!0)),k=l(h);g(()=>u(k,`${a(t).total_tracks} Track${a(t).total_tracks>1?"s":""}`)),x(i,m)}}}),x(s,o),q()}export{it as component,nt as universal};
