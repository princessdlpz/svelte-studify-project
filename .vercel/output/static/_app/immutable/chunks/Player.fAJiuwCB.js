import{i as Ve,h as j,a as m,f as k,s as te,n as Ae,t as R,c as v,e as A,b as D,d as ee,g as We}from"./disclose-version.B-hLH5kf.js";import{r as Q,p as Me,m as C,l as ie,c as Ke,a as ze,s as y,g as a,b as Qe,M as o,a9 as Xe,d as Be}from"./runtime.DDjRgbeA.js";import{i as T}from"./if.BIDFABO2.js";import{s as r,b as ue,i as me,r as ke}from"./index.DJuFnhGY.js";import{a as fe}from"./actions.B3legGYV.js";import{t as pe}from"./class.CTwLLMHQ.js";import{b as Ee}from"./this.BVWmpjgx.js";import{i as Ce}from"./lifecycle.Dwr_-_8E.js";import{l as se,s as oe,p as je}from"./props.GCjS4c-Y.js";import{u as $e,s as ea,p as aa}from"./stores.B95OUsOV.js";import{b as ta}from"./entry.BA7IWL2S.js";import{B as sa}from"./Button.Dse6T-Vv.js";import{o as oa,c as ra}from"./index-client.Dvsx0NXl.js";import"./HeaderNav.svelte_svelte_type_style_lang.BOaGD4ME.js";import{h as be,t as na}from"./tippy.DIS1eJDj.js";import{e as Ie}from"./forms.DlGDJt_k.js";import{t as Z}from"./toasts.CMPPch6U.js";import{I as re}from"./Icon.gh31iTKL.js";function _e(t,e,l,d=!0){d&&l();for(var s of e)t.addEventListener(s,l);Q(()=>()=>{for(var n of e)t.removeEventListener(n,l)})}function ia(t,e,l){var d=Ve,s=e(),n=()=>{s!==t.paused&&(s=t.paused,l(s=t.paused))};s==null&&n(),d&&_e(t,["play","pause","canplay"],n,!1),Q(()=>{if(s=!!e(),s!==t.paused){var c=()=>{d=!0,s?t.pause():t.play().catch(()=>{l(s=!0)})};d?c():t.addEventListener("canplay",()=>{_e(t,["play","pause","canplay"],n,!1),c()},{once:!0})}})}function Aa(t,e){const l=se(e,["children","$$slots","$$events"]),d=[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 8 14"}]];var s=j(),n=k(s);re(n,oe({name:"clock-8"},()=>l,{iconNode:d,children:(c,h)=>{var u=j(),f=k(u);te(f,e.children,{}),m(c,u)}})),m(t,s)}function la(t,e){const l=se(e,["children","$$slots","$$events"]),d=[["path",{d:"M11 12H3"}],["path",{d:"M16 6H3"}],["path",{d:"M16 18H3"}],["path",{d:"M18 9v6"}],["path",{d:"M21 12h-6"}]];var s=j(),n=k(s);re(n,oe({name:"list-plus"},()=>l,{iconNode:d,children:(c,h)=>{var u=j(),f=k(u);te(f,e.children,{}),m(c,u)}})),m(t,s)}function ca(t,e){const l=se(e,["children","$$slots","$$events"]),d=[["path",{d:"M11 12H3"}],["path",{d:"M16 6H3"}],["path",{d:"M16 18H3"}],["path",{d:"m19 10-4 4"}],["path",{d:"m15 10 4 4"}]];var s=j(),n=k(s);re(n,oe({name:"list-x"},()=>l,{iconNode:d,children:(c,h)=>{var u=j(),f=k(u);te(f,e.children,{}),m(c,u)}})),m(t,s)}function da(t,e){const l=se(e,["children","$$slots","$$events"]),d=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}]];var s=j(),n=k(s);re(n,oe({name:"pause"},()=>l,{iconNode:d,children:(c,h)=>{var u=j(),f=k(u);te(f,e.children,{}),m(c,u)}})),m(t,s)}function va(t,e){const l=se(e,["children","$$slots","$$events"]),d=[["polygon",{points:"6 3 20 12 6 21 6 3"}]];var s=j(),n=k(s);re(n,oe({name:"play"},()=>l,{iconNode:d,children:(c,h)=>{var u=j(),f=k(u);te(f,e.children,{}),m(c,u)}})),m(t,s)}function ua(t){const e=Math.floor(t/1e3%60),l=Math.floor(t/(1e3*60)%60),d=Math.floor(t/(1e3*60*60)%24),s=l===0?"00":l,n=e<10?"0"+e:e;return`${d>0?`${d}:`:""}${s}:${n}`}function ma(t,e,l){return{down:()=>{if(e===null)return[2,1,1];if(e[0]<l+1)return[e[0]+1,e[1],1]},up:()=>{if(e===null)return[2,1,1];if(e[0]>2)return[e[0]-1,e[1],1]},right:()=>{if(e===null)return[2,1,1];if(t&&e){const s=[...t.querySelectorAll(`[data-row="${e[0]}"]`)].map(n=>n.querySelectorAll("a:not(.not-selectable),button:not(.not-selectable)").length);for(let n=0;n<s.length;n++){const c=n+1,h=e[1],u=e[2];if(h===c&&u<s[c-1])return[e[0],e[1],e[2]+1];if(h<c&&s[c-1])return[e[0],c,1]}}},left:()=>{if(e===null)return[2,1,1];if(t&&e){const s=[...t.querySelectorAll(`[data-row="${e[0]}"]`)].map(n=>n.querySelectorAll("a:not(.not-selectable),button:not(.not-selectable)").length);for(let n=s.length-1;n>=0;n--){const c=n+1,h=e[1],u=e[2];if(h===c&&u>1)return[e[0],e[1],e[2]-1];if(h>c&&s[c-1])return[e[0],c,s[c-1]]}}},lastRow:()=>[l+1,(e==null?void 0:e[1])||1,1],firstRow:()=>[2,(e==null?void 0:e[1])||1,1],firstCell:()=>[2,1,1],lastCell:()=>[l+1,4,1],firstCellInCurrentRow:()=>e?[e[0],1,1]:[2,1,1],lastCellInCurrentRow:()=>e?[e[0],4,1]:[2,4,1]}}function fa(t,e,l){switch(t.key){case"ArrowDown":return t.preventDefault(),be(),e.down();case"ArrowUp":return t.preventDefault(),be(),e.up();case"ArrowRight":return t.preventDefault(),e.right();case"ArrowLeft":return t.preventDefault(),e.left();case"PageDown":return t.preventDefault(),e.lastRow();case"PageUp":return t.preventDefault(),e.firstRow();case"Home":{if(t.preventDefault(),l)return t.ctrlKey?e.firstCell():e.firstCellInCurrentRow();break}case"End":if(t.preventDefault(),l)return t.ctrlKey?e.lastCell():e.lastCellInCurrentRow();break}}const pa="data:image/gif;base64,R0lGODlhGAAYAPABAB25VP///yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDAyIDc5LjE2NDM1MiwgMjAyMC8wMS8zMC0xNTo1MDozOCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjNDRDUyN0E0OTUwRDExRUE4NDY1QkYwRjJDNTZBRkY4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjNDRDUyN0E1OTUwRDExRUE4NDY1QkYwRjJDNTZBRkY4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6M0NENTI3QTI5NTBEMTFFQTg0NjVCRjBGMkM1NkFGRjgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0NENTI3QTM5NTBEMTFFQTg0NjVCRjBGMkM1NkFGRjgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++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";var ba=R('<img class="playing-gif svelte-boz81k" alt="">'),ha=R('<span class="number svelte-boz81k"> </span>'),ga=R('<span class="explicit svelte-boz81k">Explicit</span>'),wa=R('<a class="svelte-boz81k"> </a><!>',1),ya=R('<form method="POST"><input hidden name="track"> <button type="submit" class="remove-pl-button svelte-boz81k"><!></button></form>'),Qa=R("<option> </option>"),Ba=R('Add <span class="visually-hidden"> </span>',1),ka=R('<div class="playlists-menu svelte-boz81k" style="display: none;"><div class="playlists-menu-content svelte-boz81k"><form method="POST" class="svelte-boz81k"><input hidden name="track"> <div class="field svelte-boz81k"><select aria-label="Playlist" name="playlist" class="svelte-boz81k"></select></div> <div class="submit-button svelte-boz81k"><!></div></form></div></div>'),Ia=R('<button class="add-pl-button svelte-boz81k"><!></button> <!>',1),_a=R('<div class="row svelte-boz81k" role="row"><div class="number-column svelte-boz81k" role="gridcell"><!> <div class="player svelte-boz81k"><!></div></div> <div class="info-column svelte-boz81k" role="gridcell"><div class="track-title svelte-boz81k"><h4 class="svelte-boz81k"> </h4> <!></div> <p class="artists svelte-boz81k"></p></div> <div class="duration-column svelte-boz81k" role="gridcell"><span class="duration svelte-boz81k"> </span></div> <div class="actions-column svelte-boz81k" role="gridcell"><!></div></div>'),Ma=R('<div class="tracks svelte-boz81k" role="grid"><div class="row header svelte-boz81k" role="row"><div class="number-column svelte-boz81k" role="columnheader"><span class="number svelte-boz81k">#</span></div> <div class="info-column svelte-boz81k" role="columnheader"><span class="track-title svelte-boz81k">Title</span></div> <div class="duration-column svelte-boz81k" role="columnheader"><!></div> <div class="actions-column svelte-boz81k" role="columnheader"></div></div> <!></div>');function Ta(t,e){Me(e,!1);const l={};$e(l);const d=()=>ea(aa,"$page",l),s=C(),n=C();let c=je(e,"isOwner",0,!1),h=C(null),u=C(!1),f=C([]),J=C([]),U=C(!1),M=C(e.tracks.length),_=C(null),p=C(null);function Re(L){const i=fa(L,a(s),a(p));i&&y(p,i)}oa(()=>{y(U,!0)}),ie(()=>(a(M),Qe(e.tracks)),()=>{a(M)<e.tracks.length&&y(p,[a(M)+2,1,1]),y(M,e.tracks.length)}),ie(()=>(a(_),a(p),Qe(e.tracks)),()=>{y(s,ma(a(_),a(p),e.tracks.length))}),ie(()=>(a(U),a(p)),()=>{y(n,(L,i,g)=>{if(a(U))return a(p)&&a(p)[0]===L&&a(p)[1]===i&&a(p)[2]===g?0:-1})}),ie(()=>(a(p),a(_)),()=>{(async()=>{if(a(p)&&a(_)){await Xe();const i=a(_).querySelector(`[data-row="${a(p)[0]}"][data-column="${a(p)[1]}"]`),g=i==null?void 0:i.querySelectorAll("a:not(.not-selectable),button:not(.not-selectable)");console.log(g),g&&g[a(p)[2]-1].focus()}})()}),Ke(),Ce();var P=Ma();Ee(P,L=>y(_,L),()=>a(_)),r(P,"aria-colcount",5);var le=v(P);r(le,"aria-rowindex",1);var ce=v(le);r(ce,"aria-colindex",1),r(ce,"data-row",1);var de=A(A(ce,!0));r(de,"aria-colindex",2),r(de,"data-row",1);var ne=A(A(de,!0));r(ne,"aria-colindex",3),r(ne,"data-row",1);var Je=v(ne);Aa(Je,{"aria-hidden":!0,focusable:"false",color:"var(--light-gray)"});var ve=A(A(ne,!0));r(ve,"aria-colindex",4),r(ve,"data-row",1);var De=A(A(le,!0));ue(De,1,()=>e.tracks,me,(L,i,g)=>{var V=_a();r(V,"aria-rowindex",o(g)+2);var W=v(V);r(W,"aria-colindex",1),r(W,"data-column",1),r(W,"data-row",o(g)+2);var he=v(W);T(he,()=>a(h)===o(i).id&&!a(u),B=>{var b=ba();r(b,"src",pa),m(B,b)},B=>{var b=ha(),w=v(b);w.nodeValue=D(o(g)+1),m(B,b)});var Ge=A(A(he,!0)),Ye=v(Ge),xe=Be(()=>a(n)(o(g)+2,1,1));Ea(Ye,{get tabIndex(){return a(xe)},get track(){return o(i)},$$events:{play:B=>{y(h,B.detail.track.id),y(u,!1)},pause:B=>{y(u,B.detail.track.id===a(h))}}});var K=A(A(W,!0));r(K,"aria-colindex",2),r(K,"data-column",2),r(K,"data-row",o(g)+2);var ge=v(K),we=v(ge),qe=v(we),Pe=A(A(we,!0));T(Pe,()=>o(i).explicit,B=>{var b=ga();m(B,b)});var Le=A(A(ge,!0));ue(Le,9,()=>o(i).artists,me,(B,b,w)=>{var G=wa(),F=k(G);Q(()=>r(F,"tabindex",a(n)(o(g)+2,2,o(w)+1)));var z=v(F),I=A(F);T(I,()=>o(w)<o(i).artists.length-1,Y=>{var x=We(Y);x.nodeValue=D(", "),m(Y,x)}),Q(()=>{r(F,"href",`/artist/${D(o(b).id)}`),ee(z,o(b).name)}),m(B,G)});var X=A(A(K,!0));r(X,"aria-colindex",3),r(X,"data-column",3),r(X,"data-row",o(g)+2);var Fe=v(X),Se=v(Fe);Q(()=>ee(Se,ua(o(i).duration_ms)));var $=A(A(X,!0));r($,"aria-colindex",4),r($,"data-column",4),r($,"data-row",o(g)+2);var He=v($);T(He,c,B=>{var b=ya(),w=v(b);ke(w);var G=A(A(w,!0));Q(()=>r(G,"tabindex",a(n)(o(g)+2,4,1))),Q(()=>G.disabled=a(J).includes(o(i).id));var F=v(G);ca(F,{"aria-hidden":!0,focusable:"false"}),Q(()=>{r(b,"action",`/playlist/${D(d().params.id)}?/removeItem`),w.value=o(i).id,r(G,"title",`Remove ${D(o(i).name)} from playlist`),r(G,"aria-label",`Remove ${D(o(i).name)} from playlist`)}),fe(b,(z,I)=>Ie(z,I),()=>({cancel:z})=>(a(J).includes(o(i).id)&&z(),y(J,[...a(J),o(i).id]),({result:I})=>{if(I.type==="error"&&Z.error(I.error.message),I.type==="redirect"){const Y=new URL(`${d().url.origin}${I.location}`),x=Y.searchParams.get("error"),O=Y.searchParams.get("success");x&&Z.error(x),O&&(Z.success(O),ta(`/api/spotify/playlists/${d().params.id}`))}y(J,a(J).filter(Y=>Y!==o(i).id))})),m(B,b)},B=>{var b=Ia(),w=k(b);Q(()=>r(w,"tabindex",a(n)(o(g)+2,4,1)));var G=v(w);la(G,{"aria-hidden":!0,focusable:"false"});var F=A(A(w,!0));T(F,()=>e.userPlaylists,z=>{var I=ka(),Y=v(I),x=v(Y),O=v(x);ke(O);var ye=A(A(O,!0)),Ne=v(ye);ue(Ne,9,()=>e.userPlaylists,me,(H,E,S)=>{var q=Qa(),N,Te=v(q);Q(()=>{N!==(N=o(E).id)&&(q.value=(q.__value=o(E).id)==null?"":o(E).id),ee(Te,o(E).name)}),m(H,q)});var Ue=A(A(ye,!0)),Oe=v(Ue),Ze=Be(()=>a(f).includes(o(i).id));sa(Oe,{get disabled(){return a(Ze)},element:"button",type:"submit",className:"not-selectable",children:(H,E)=>{var S=Ba(),q=A(k(S,!0)),N=v(q);Q(()=>ee(N,`${D(o(i).name)} to selected playlist.`)),m(H,S)}}),Q(()=>{r(I,"id",`${D(o(i).id)}-playlists-menu`),r(x,"action",`/playlist?/addItem&redirect=${D(d().url.pathname)}`),O.value=o(i).id}),fe(x,(H,E)=>Ie(H,E),()=>({cancel:H})=>(a(f).includes(o(i).id)&&H(),y(f,[...a(f),o(i).id]),({result:E})=>{if(E.type==="error"&&Z.error(E.error.message),E.type==="redirect"){const S=new URL(`${d().url.origin}${E.location}`),q=S.searchParams.get("error"),N=S.searchParams.get("success");q&&Z.error(q),N&&(Z.success(N),be())}y(f,a(f).filter(S=>S!==o(i).id))})),m(z,I)}),Q(()=>{r(w,"title",`Add ${D(o(i).name)} to a playlist`),r(w,"aria-label",`Add ${D(o(i).name)} to a playlist`),w.disabled=!e.userPlaylists}),fe(w,(z,I)=>na(z,I),()=>({content:document.getElementById(`${o(i).id}-playlists-menu`)||void 0,allowHTML:!0,trigger:"click",interactive:!0,theme:"menu",placement:"bottom-end",onMount:()=>{const z=document.getElementById(`${o(i).id}-playlists-menu`);z&&(z.style.display="block")}})),m(B,b)}),Q(()=>{r(V,"aria-selected",a(p)&&a(p)[0]===o(g)+2?"true":"false"),pe(V,"is-current",a(h)===o(i).id),ee(qe,o(i).name),pe($,"is-owner",c())}),m(L,V)}),Q(()=>{r(P,"aria-label",e.title),r(P,"aria-rowcount",e.total+1),r(P,"tabindex",a(U)?0:void 0),pe(ve,"is-owner",c())}),Ae("keydown",P,Re,!1),m(t,P),ze()}var za=R('<div class="player svelte-m4cq80"><audio controls preload="none" class="svelte-m4cq80"></audio> <button class="svelte-m4cq80"><!></button></div>');let ae;function Ea(t,e){Me(e,!1);let l=je(e,"tabIndex",0,void 0);const d=ra();let s=C(),n=C(!0);function c(){ae&&ae!==a(s)&&(ae.currentTime=0,ae.pause()),ae=a(s),d("play",{track:e.track})}function h(){d("pause",{track:e.track})}Ce();var u=za(),f=v(u);Ee(f,M=>y(s,M),()=>a(s));var J=A(A(f,!0)),U=v(J);T(U,()=>a(n),M=>{var _=j(),p=k(_);va(p,{color:"var(--text-color)",focusable:"false","aria-hidden":!0}),m(M,_)},M=>{var _=j(),p=k(_);da(p,{color:"var(--text-color)",focusable:"false","aria-hidden":!0}),m(M,_)}),Q(()=>{r(f,"src",e.track.preview_url),r(J,"tabindex",l()),r(J,"aria-label",a(n)?`Play ${e.track.name}`:`Pause ${e.track.name}`)}),Ae("play",f,c,!1),Ae("pause",f,h,!1),ia(f,()=>a(n),M=>y(n,M)),Ae("click",J,()=>{a(n)?a(s).play():a(s).pause()},!1),m(t,u),ze()}export{Ta as T};
